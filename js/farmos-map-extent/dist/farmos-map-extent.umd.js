(function(w){typeof define=="function"&&define.amd?define(w):w()})(function(){"use strict";var w={RADIANS:"radians",DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},N={};N[w.RADIANS]=6370997/(2*Math.PI),N[w.DEGREES]=2*Math.PI*6370997/360,N[w.FEET]=.3048,N[w.METERS]=1,N[w.USFEET]=1200/3937;var K=w,_e=function(){function n(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}return n.prototype.canWrapX=function(){return this.canWrapX_},n.prototype.getCode=function(){return this.code_},n.prototype.getExtent=function(){return this.extent_},n.prototype.getUnits=function(){return this.units_},n.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||N[this.units_]},n.prototype.getWorldExtent=function(){return this.worldExtent_},n.prototype.getAxisOrientation=function(){return this.axisOrientation_},n.prototype.isGlobal=function(){return this.global_},n.prototype.setGlobal=function(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)},n.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},n.prototype.setDefaultTileGrid=function(e){this.defaultTileGrid_=e},n.prototype.setExtent=function(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)},n.prototype.setWorldExtent=function(e){this.worldExtent_=e},n.prototype.setGetPointResolution=function(e){this.getPointResolutionFunc_=e},n.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},n}(),Pt=_e,de=function(){var n;return"cosh"in Math?n=Math.cosh:n=function(e){var t=Math.exp(e);return(t+1/t)/2},n}();function Ee(n,e,t,r,i,o){var a=i-t,s=o-r;if(a!==0||s!==0){var u=((n-t)*a+(e-r)*s)/(a*a+s*s);u>1?(t=i,r=o):u>0&&(t+=a*u,r+=s*u)}return G(n,e,t,r)}function G(n,e,t,r){var i=t-n,o=r-e;return i*i+o*o}function q(n,e,t){return n+t*(e-n)}var me=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),j=6378137,I=Math.PI*j,Te=[-I,-I,I,I],Pe=[-180,-85,180,85],D=j*Math.log(Math.tan(Math.PI/2)),x=function(n){me(e,n);function e(t){return n.call(this,{code:t,units:K.METERS,extent:Te,global:!0,worldExtent:Pe,getPointResolution:function(r,i){return r/de(i[1]/j)}})||this}return e}(Pt),Ct=[new x("EPSG:3857"),new x("EPSG:102100"),new x("EPSG:102113"),new x("EPSG:900913"),new x("http://www.opengis.net/def/crs/EPSG/0/3857"),new x("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Ce(n,e,t){var r=n.length,i=t>1?t:2,o=e;o===void 0&&(i>2?o=n.slice():o=new Array(r));for(var a=0;a<r;a+=i){o[a]=I*n[a]/180;var s=j*Math.log(Math.tan(Math.PI*(+n[a+1]+90)/360));s>D?s=D:s<-D&&(s=-D),o[a+1]=s}return o}function we(n,e,t){var r=n.length,i=t>1?t:2,o=e;o===void 0&&(i>2?o=n.slice():o=new Array(r));for(var a=0;a<r;a+=i)o[a]=180*n[a]/I,o[a+1]=360*Math.atan(Math.exp(n[a+1]/j))/Math.PI-90;return o}var Re=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Oe=6378137,wt=[-180,-90,180,90],Ge=Math.PI*Oe/180,M=function(n){Re(e,n);function e(t,r){return n.call(this,{code:t,units:K.DEGREES,extent:wt,axisOrientation:r,global:!0,metersPerUnit:Ge,worldExtent:wt})||this}return e}(Pt),Rt=[new M("CRS:84"),new M("EPSG:4326","neu"),new M("urn:ogc:def:crs:OGC:1.3:CRS84"),new M("urn:ogc:def:crs:OGC:2:84"),new M("http://www.opengis.net/def/crs/OGC/1.3/CRS84","neu"),new M("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new M("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],b={};function Me(n){return b[n]||b[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function Le(n,e){b[n]=e}var tt=typeof Object.assign=="function"?Object.assign:function(n,e){if(n==null)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(n),r=1,i=arguments.length;r<i;++r){var o=arguments[r];if(o!=null)for(var a in o)o.hasOwnProperty(a)&&(t[a]=o[a])}return t};function Ot(n){for(var e in n)delete n[e]}function Se(n){var e;for(e in n)return!1;return!e}var X={};function B(n,e,t){var r=n.getCode(),i=e.getCode();r in X||(X[r]={}),X[r][i]=t}function Ae(n,e){var t;return n in X&&e in X[n]&&(t=X[n][e]),t}var T={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function E(){return function(){throw new Error("Unimplemented abstract method.")}()}var Fe=0;function Ne(n){return n.ol_uid||(n.ol_uid=String(++Fe))}var Ie="6.9.0",xe=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Xe=function(n){xe(e,n);function e(t){var r=this,i="v"+Ie.split("-")[0],o="Assertion failed. See https://openlayers.org/en/"+i+"/doc/errors/#"+t+" for details.";return r=n.call(this,o)||this,r.code=t,r.name="AssertionError",r.message=o,r}return e}(Error),Ye=Xe;function Ue(n,e){if(!n)throw new Ye(e)}function je(n,e,t){var r=Math.min.apply(null,n),i=Math.min.apply(null,e),o=Math.max.apply(null,n),a=Math.max.apply(null,e);return rt(r,i,o,a,t)}function L(n,e,t){var r,i;return e<n[0]?r=n[0]-e:n[2]<e?r=e-n[2]:r=0,t<n[1]?i=n[1]-t:n[3]<t?i=t-n[3]:i=0,r*r+i*i}function $e(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function Gt(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function Mt(n,e){var t=n[0],r=n[1],i=n[2],o=n[3],a=e[0],s=e[1],u=T.UNKNOWN;return a<t?u=u|T.LEFT:a>i&&(u=u|T.RIGHT),s<r?u=u|T.BELOW:s>o&&(u=u|T.ABOVE),u===T.UNKNOWN&&(u=T.INTERSECTING),u}function et(){return[1/0,1/0,-1/0,-1/0]}function rt(n,e,t,r,i){return i?(i[0]=n,i[1]=e,i[2]=t,i[3]=r,i):[n,e,t,r]}function nt(n){return rt(1/0,1/0,-1/0,-1/0,n)}function We(n,e){var t=n[0],r=n[1];return rt(t,r,t,r,e)}function Lt(n,e,t,r,i){var o=nt(i);return St(o,n,e,t,r)}function Ke(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function St(n,e,t,r,i){for(;t<r;t+=i)De(n,e[t],e[t+1]);return n}function De(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function Be(n,e){var t;return t=e(At(n)),t||(t=e(Ft(n)),t)||(t=e(xt(n)),t)||(t=e(It(n)),t)?t:!1}function At(n){return[n[0],n[1]]}function Ft(n){return[n[2],n[1]]}function it(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function Nt(n){return n[3]-n[1]}function It(n){return[n[0],n[3]]}function xt(n){return[n[2],n[3]]}function He(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function Ze(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function ke(n,e,t){var r=!1,i=Mt(n,e),o=Mt(n,t);if(i===T.INTERSECTING||o===T.INTERSECTING)r=!0;else{var a=n[0],s=n[1],u=n[2],h=n[3],l=e[0],f=e[1],c=t[0],p=t[1],v=(p-f)/(c-l),y=void 0,d=void 0;!!(o&T.ABOVE)&&!(i&T.ABOVE)&&(y=c-(p-h)/v,r=y>=a&&y<=u),!r&&!!(o&T.RIGHT)&&!(i&T.RIGHT)&&(d=p-(c-u)*v,r=d>=s&&d<=h),!r&&!!(o&T.BELOW)&&!(i&T.BELOW)&&(y=c-(p-s)/v,r=y>=a&&y<=u),!r&&!!(o&T.LEFT)&&!(i&T.LEFT)&&(d=p-(c-a)*v,r=d>=s&&d<=h)}return r}function Ve(n,e,t,r){var i=[];if(r>1)for(var o=n[2]-n[0],a=n[3]-n[1],s=0;s<r;++s)i.push(n[0]+o*s/r,n[1],n[2],n[1]+a*s/r,n[2]-o*s/r,n[3],n[0],n[3]-a*s/r);else i=[n[0],n[1],n[2],n[1],n[2],n[3],n[0],n[3]];e(i,i,2);for(var u=[],h=[],s=0,l=i.length;s<l;s+=2)u.push(i[s]),h.push(i[s+1]);return je(u,h,t)}var P={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"};function ot(n,e,t){var r;if(e!==void 0){for(var i=0,o=n.length;i<o;++i)e[i]=n[i];r=e}else r=n.slice();return r}function ze(n,e,t){if(e!==void 0&&n!==e){for(var r=0,i=n.length;r<i;++r)e[r]=n[r];n=e}return n}function Je(n){Le(n.getCode(),n),B(n,n,ot)}function Qe(n){n.forEach(Je)}function S(n){return typeof n=="string"?Me(n):n||null}function Xt(n){Qe(n),n.forEach(function(e){n.forEach(function(t){e!==t&&B(e,t,ot)})})}function qe(n,e,t,r){n.forEach(function(i){e.forEach(function(o){B(i,o,t),B(o,i,r)})})}function be(n,e){if(n===e)return!0;var t=n.getUnits()===e.getUnits();if(n.getCode()===e.getCode())return t;var r=Yt(n,e);return r===ot&&t}function Yt(n,e){var t=n.getCode(),r=e.getCode(),i=Ae(t,r);return i||(i=ze),i}function at(n,e){var t=S(n),r=S(e);return Yt(t,r)}function tr(n,e,t,r){var i=at(e,t);return Ve(n,i,void 0,r)}function er(){Xt(Ct),Xt(Rt),qe(Rt,Ct,Ce,we)}er();var rr=function(){function n(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}return n.prototype.preventDefault=function(){this.defaultPrevented=!0},n.prototype.stopPropagation=function(){this.propagationStopped=!0},n}(),Ut=rr,nr={PROPERTYCHANGE:"propertychange"},ir=function(){function n(){this.disposed=!1}return n.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.disposeInternal())},n.prototype.disposeInternal=function(){},n}(),or=ir;function ar(n,e,t){for(var r,i,o=t||jt,a=0,s=n.length,u=!1;a<s;)r=a+(s-a>>1),i=+o(n[r],e),i<0?a=r+1:(s=r,u=!i);return u?a:~a}function jt(n,e){return n>e?1:n<e?-1:0}function O(n,e){for(var t=Array.isArray(e)?e:[e],r=t.length,i=0;i<r;i++)n[n.length]=t[i]}function sr(n,e){var t=n.length;if(t!==e.length)return!1;for(var r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function $t(){}function ur(n){var e=!1,t,r,i;return function(){var o=Array.prototype.slice.call(arguments);return(!e||this!==i||!sr(o,r))&&(e=!0,i=this,r=o,t=n.apply(this,arguments)),t}}var hr=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),lr=function(n){hr(e,n);function e(t){var r=n.call(this)||this;return r.eventTarget_=t,r.pendingRemovals_=null,r.dispatching_=null,r.listeners_=null,r}return e.prototype.addEventListener=function(t,r){if(!(!t||!r)){var i=this.listeners_||(this.listeners_={}),o=i[t]||(i[t]=[]);o.indexOf(r)===-1&&o.push(r)}},e.prototype.dispatchEvent=function(t){var r=typeof t=="string"?new Ut(t):t,i=r.type;r.target||(r.target=this.eventTarget_||this);var o=this.listeners_&&this.listeners_[i],a;if(o){var s=this.dispatching_||(this.dispatching_={}),u=this.pendingRemovals_||(this.pendingRemovals_={});i in s||(s[i]=0,u[i]=0),++s[i];for(var h=0,l=o.length;h<l;++h)if("handleEvent"in o[h]?a=o[h].handleEvent(r):a=o[h].call(this,r),a===!1||r.propagationStopped){a=!1;break}if(--s[i],s[i]===0){var f=u[i];for(delete u[i];f--;)this.removeEventListener(i,$t);delete s[i]}return a}},e.prototype.disposeInternal=function(){this.listeners_&&Ot(this.listeners_)},e.prototype.getListeners=function(t){return this.listeners_&&this.listeners_[t]||void 0},e.prototype.hasListener=function(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1},e.prototype.removeEventListener=function(t,r){var i=this.listeners_&&this.listeners_[t];if(i){var o=i.indexOf(r);o!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[o]=$t,++this.pendingRemovals_[t]):(i.splice(o,1),i.length===0&&delete this.listeners_[t]))}},e}(or),fr=lr,st={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function $(n,e,t,r,i){if(r&&r!==n&&(t=t.bind(r)),i){var o=t;t=function(){n.removeEventListener(e,t),o.apply(this,arguments)}}var a={target:n,type:e,listener:t};return n.addEventListener(e,t),a}function Wt(n,e,t,r){return $(n,e,t,r,!0)}function H(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),Ot(n))}var cr=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Z=function(n){cr(e,n);function e(){var t=n.call(this)||this;return t.on=t.onInternal,t.once=t.onceInternal,t.un=t.unInternal,t.revision_=0,t}return e.prototype.changed=function(){++this.revision_,this.dispatchEvent(st.CHANGE)},e.prototype.getRevision=function(){return this.revision_},e.prototype.onInternal=function(t,r){if(Array.isArray(t)){for(var i=t.length,o=new Array(i),a=0;a<i;++a)o[a]=$(this,t[a],r);return o}else return $(this,t,r)},e.prototype.onceInternal=function(t,r){var i;if(Array.isArray(t)){var o=t.length;i=new Array(o);for(var a=0;a<o;++a)i[a]=Wt(this,t[a],r)}else i=Wt(this,t,r);return r.ol_key=i,i},e.prototype.unInternal=function(t,r){var i=r.ol_key;if(i)pr(i);else if(Array.isArray(t))for(var o=0,a=t.length;o<a;++o)this.removeEventListener(t[o],r);else this.removeEventListener(t,r)},e}(fr);Z.prototype.on,Z.prototype.once,Z.prototype.un;function pr(n){if(Array.isArray(n))for(var e=0,t=n.length;e<t;++e)H(n[e]);else H(n)}var vr=Z,Kt=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Dt=function(n){Kt(e,n);function e(t,r,i){var o=n.call(this,t)||this;return o.key=r,o.oldValue=i,o}return e}(Ut),yr=function(n){Kt(e,n);function e(t){var r=n.call(this)||this;return r.on,r.once,r.un,Ne(r),r.values_=null,t!==void 0&&r.setProperties(t),r}return e.prototype.get=function(t){var r;return this.values_&&this.values_.hasOwnProperty(t)&&(r=this.values_[t]),r},e.prototype.getKeys=function(){return this.values_&&Object.keys(this.values_)||[]},e.prototype.getProperties=function(){return this.values_&&tt({},this.values_)||{}},e.prototype.hasProperties=function(){return!!this.values_},e.prototype.notify=function(t,r){var i;i="change:"+t,this.dispatchEvent(new Dt(i,t,r)),i=nr.PROPERTYCHANGE,this.dispatchEvent(new Dt(i,t,r))},e.prototype.addChangeListener=function(t,r){this.addEventListener("change:"+t,r)},e.prototype.removeChangeListener=function(t,r){this.removeEventListener("change:"+t,r)},e.prototype.set=function(t,r,i){var o=this.values_||(this.values_={});if(i)o[t]=r;else{var a=o[t];o[t]=r,a!==r&&this.notify(t,a)}},e.prototype.setProperties=function(t,r){for(var i in t)this.set(i,t[i],r)},e.prototype.applyProperties=function(t){!t.values_||tt(this.values_||(this.values_={}),t.values_)},e.prototype.unset=function(t,r){if(this.values_&&t in this.values_){var i=this.values_[t];delete this.values_[t],Se(this.values_)&&(this.values_=null),r||this.notify(t,i)}},e}(vr),Bt=yr,gr=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),_r=function(n){gr(e,n);function e(t){var r=n.call(this)||this;if(r.on,r.once,r.un,r.id_=void 0,r.geometryName_="geometry",r.style_=null,r.styleFunction_=void 0,r.geometryChangeKey_=null,r.addChangeListener(r.geometryName_,r.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){var i=t;r.setGeometry(i)}else{var o=t;r.setProperties(o)}return r}return e.prototype.clone=function(){var t=new e(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var r=this.getGeometry();r&&t.setGeometry(r.clone());var i=this.getStyle();return i&&t.setStyle(i),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(H(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=$(t,st.CHANGE,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?dr(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()},e}(Bt);function dr(n){if(typeof n=="function")return n;var e;if(Array.isArray(n))e=n;else{Ue(typeof n.getZIndex=="function",41);var t=n;e=[t]}return function(){return e}}var Ht=_r,_={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"},Er=function(){function n(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.supportedMediaTypes=null}return n.prototype.getReadOptions=function(e,t){var r;if(t){var i=t.dataProjection?S(t.dataProjection):this.readProjection(e);t.extent&&i&&i.getUnits()===K.TILE_PIXELS&&(i=S(i),i.setWorldExtent(t.extent)),r={dataProjection:i,featureProjection:t.featureProjection}}return this.adaptOptions(r)},n.prototype.adaptOptions=function(e){return tt({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},e)},n.prototype.getType=function(){return E()},n.prototype.readFeature=function(e,t){return E()},n.prototype.readFeatures=function(e,t){return E()},n.prototype.readGeometry=function(e,t){return E()},n.prototype.readProjection=function(e){return E()},n.prototype.writeFeature=function(e,t){return E()},n.prototype.writeFeatures=function(e,t){return E()},n.prototype.writeGeometry=function(e,t){return E()},n}();function Zt(n,e,t){var r=t?S(t.featureProjection):null,i=t?S(t.dataProjection):null,o;if(r&&i&&!be(r,i)?o=(e?n.clone():n).transform(e?r:i,e?i:r):o=n,e&&t&&t.decimals!==void 0){var a=Math.pow(10,t.decimals),s=function(u){for(var h=0,l=u.length;h<l;++h)u[h]=Math.round(u[h]*a)/a;return u};o===n&&(o=n.clone()),o.applyTransform(s)}return o}var mr={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"};new Array(6);function Tr(){return[1,0,0,1,0,0]}function Pr(n,e,t,r,i,o,a,s){var u=Math.sin(o),h=Math.cos(o);return n[0]=r*h,n[1]=i*u,n[2]=-r*u,n[3]=i*h,n[4]=a*r*h-s*r*u+e,n[5]=a*i*u+s*i*h+t,n}function Cr(n,e,t,r,i,o){for(var a=o||[],s=0,u=e;u<t;u+=r){var h=n[u],l=n[u+1];a[s++]=i[0]*h+i[2]*l+i[4],a[s++]=i[1]*h+i[3]*l+i[5]}return o&&a.length!=s&&(a.length=s),a}function wr(n,e,t,r,i,o,a){for(var s=a||[],u=Math.cos(i),h=Math.sin(i),l=o[0],f=o[1],c=0,p=e;p<t;p+=r){var v=n[p]-l,y=n[p+1]-f;s[c++]=l+v*u-y*h,s[c++]=f+v*h+y*u;for(var d=p+2;d<p+r;++d)s[c++]=n[d]}return a&&s.length!=c&&(s.length=c),s}function Rr(n,e,t,r,i,o,a,s){for(var u=s||[],h=a[0],l=a[1],f=0,c=e;c<t;c+=r){var p=n[c]-h,v=n[c+1]-l;u[f++]=h+i*p,u[f++]=l+o*v;for(var y=c+2;y<c+r;++y)u[f++]=n[y]}return s&&u.length!=f&&(u.length=f),u}function Or(n,e,t,r,i,o,a){for(var s=a||[],u=0,h=e;h<t;h+=r){s[u++]=n[h]+i,s[u++]=n[h+1]+o;for(var l=h+2;l<h+r;++l)s[u++]=n[l]}return a&&s.length!=u&&(s.length=u),s}var Gr=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),kt=Tr(),Mr=function(n){Gr(e,n);function e(){var t=n.call(this)||this;return t.extent_=et(),t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=ur(function(r,i,o){if(!o)return this.getSimplifiedGeometry(i);var a=this.clone();return a.applyTransform(o),a.getSimplifiedGeometry(i)}),t}return e.prototype.simplifyTransformed=function(t,r){return this.simplifyTransformedInternal(this.getRevision(),t,r)},e.prototype.clone=function(){return E()},e.prototype.closestPointXY=function(t,r,i,o){return E()},e.prototype.containsXY=function(t,r){var i=this.getClosestPoint([t,r]);return i[0]===t&&i[1]===r},e.prototype.getClosestPoint=function(t,r){var i=r||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return E()},e.prototype.getExtent=function(t){if(this.extentRevision_!=this.getRevision()){var r=this.computeExtent(this.extent_);(isNaN(r[0])||isNaN(r[1]))&&nt(r),this.extentRevision_=this.getRevision()}return Ze(this.extent_,t)},e.prototype.rotate=function(t,r){E()},e.prototype.scale=function(t,r,i){E()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return E()},e.prototype.getType=function(){return E()},e.prototype.applyTransform=function(t){E()},e.prototype.intersectsExtent=function(t){return E()},e.prototype.translate=function(t,r){E()},e.prototype.transform=function(t,r){var i=S(t),o=i.getUnits()==K.TILE_PIXELS?function(a,s,u){var h=i.getExtent(),l=i.getWorldExtent(),f=Nt(l)/Nt(h);return Pr(kt,l[0],l[3],f,-f,0,0,0),Cr(a,0,a.length,u,kt,s),at(i,r)(a,s,u)}:at(i,r);return this.applyTransform(o),this},e}(Bt),Vt=Mr,Lr=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Sr=function(n){Lr(e,n);function e(){var t=n.call(this)||this;return t.layout=_.XY,t.stride=2,t.flatCoordinates=null,t}return e.prototype.computeExtent=function(t){return Lt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return E()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var r=this.getSimplifiedGeometryInternal(t),i=r.getFlatCoordinates();return i.length<this.flatCoordinates.length?r:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,r){this.stride=zt(t),this.layout=t,this.flatCoordinates=r},e.prototype.setCoordinates=function(t,r){E()},e.prototype.setLayout=function(t,r,i){var o;if(t)o=zt(t);else{for(var a=0;a<i;++a)if(r.length===0){this.layout=_.XY,this.stride=2;return}else r=r[0];o=r.length,t=Ar(o)}this.layout=t,this.stride=o},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,r){var i=this.getFlatCoordinates();if(i){var o=this.getStride();wr(i,0,i.length,o,t,r,i),this.changed()}},e.prototype.scale=function(t,r,i){var o=r;o===void 0&&(o=t);var a=i;a||(a=it(this.getExtent()));var s=this.getFlatCoordinates();if(s){var u=this.getStride();Rr(s,0,s.length,u,t,o,a,s),this.changed()}},e.prototype.translate=function(t,r){var i=this.getFlatCoordinates();if(i){var o=this.getStride();Or(i,0,i.length,o,t,r,i),this.changed()}},e}(Vt);function Ar(n){var e;return n==2?e=_.XY:n==3?e=_.XYZ:n==4&&(e=_.XYZM),e}function zt(n){var e;return n==_.XY?e=2:n==_.XYZ||n==_.XYM?e=3:n==_.XYZM&&(e=4),e}var A=Sr;function Jt(n,e,t,r,i,o,a){var s=n[e],u=n[e+1],h=n[t]-s,l=n[t+1]-u,f;if(h===0&&l===0)f=e;else{var c=((i-s)*h+(o-u)*l)/(h*h+l*l);if(c>1)f=t;else if(c>0){for(var p=0;p<r;++p)a[p]=q(n[e+p],n[t+p],c);a.length=r;return}else f=e}for(var p=0;p<r;++p)a[p]=n[f+p];a.length=r}function ut(n,e,t,r,i){var o=n[e],a=n[e+1];for(e+=r;e<t;e+=r){var s=n[e],u=n[e+1],h=G(o,a,s,u);h>i&&(i=h),o=s,a=u}return i}function ht(n,e,t,r,i){for(var o=0,a=t.length;o<a;++o){var s=t[o];i=ut(n,e,s,r,i),e=s}return i}function Fr(n,e,t,r,i){for(var o=0,a=t.length;o<a;++o){var s=t[o];i=ht(n,e,s,r,i),e=s[s.length-1]}return i}function lt(n,e,t,r,i,o,a,s,u,h,l){if(e==t)return h;var f,c;if(i===0)if(c=G(a,s,n[e],n[e+1]),c<h){for(f=0;f<r;++f)u[f]=n[e+f];return u.length=r,c}else return h;for(var p=l||[NaN,NaN],v=e+r;v<t;)if(Jt(n,v-r,v,r,a,s,p),c=G(a,s,p[0],p[1]),c<h){for(h=c,f=0;f<r;++f)u[f]=p[f];u.length=r,v+=r}else v+=r*Math.max((Math.sqrt(c)-Math.sqrt(h))/i|0,1);if(o&&(Jt(n,t-r,e,r,a,s,p),c=G(a,s,p[0],p[1]),c<h)){for(h=c,f=0;f<r;++f)u[f]=p[f];u.length=r}return h}function ft(n,e,t,r,i,o,a,s,u,h,l){for(var f=l||[NaN,NaN],c=0,p=t.length;c<p;++c){var v=t[c];h=lt(n,e,v,r,i,o,a,s,u,h,f),e=v}return h}function Nr(n,e,t,r,i,o,a,s,u,h,l){for(var f=l||[NaN,NaN],c=0,p=t.length;c<p;++c){var v=t[c];h=ft(n,e,v,r,i,o,a,s,u,h,f),e=v[v.length-1]}return h}function Ir(n,e,t,r){for(var i=0,o=t.length;i<o;++i)n[e++]=t[i];return e}function k(n,e,t,r){for(var i=0,o=t.length;i<o;++i)for(var a=t[i],s=0;s<r;++s)n[e++]=a[s];return e}function ct(n,e,t,r,i){for(var o=i||[],a=0,s=0,u=t.length;s<u;++s){var h=k(n,e,t[s],r);o[a++]=h,e=h}return o.length=a,o}function xr(n,e,t,r,i){for(var o=i||[],a=0,s=0,u=t.length;s<u;++s){var h=ct(n,e,t[s],r,o[a]);o[a++]=h,e=h[h.length-1]}return o.length=a,o}function pt(n,e,t,r,i,o,a){var s=(t-e)/r;if(s<3){for(;e<t;e+=r)o[a++]=n[e],o[a++]=n[e+1];return a}var u=new Array(s);u[0]=1,u[s-1]=1;for(var h=[e,t-r],l=0;h.length>0;){for(var f=h.pop(),c=h.pop(),p=0,v=n[c],y=n[c+1],d=n[f],U=n[f+1],m=c+r;m<f;m+=r){var C=n[m],R=n[m+1],W=Ee(C,R,v,y,d,U);W>p&&(l=m,p=W)}p>i&&(u[(l-e)/r]=1,c+r<l&&h.push(c,l),l+r<f&&h.push(l,f))}for(var m=0;m<s;++m)u[m]&&(o[a++]=n[e+m*r],o[a++]=n[e+m*r+1]);return a}function Xr(n,e,t,r,i,o,a,s){for(var u=0,h=t.length;u<h;++u){var l=t[u];a=pt(n,e,l,r,i,o,a),s.push(a),e=l}return a}function Y(n,e){return e*Math.round(n/e)}function Yr(n,e,t,r,i,o,a){if(e==t)return a;var s=Y(n[e],i),u=Y(n[e+1],i);e+=r,o[a++]=s,o[a++]=u;var h,l;do if(h=Y(n[e],i),l=Y(n[e+1],i),e+=r,e==t)return o[a++]=h,o[a++]=l,a;while(h==s&&l==u);for(;e<t;){var f=Y(n[e],i),c=Y(n[e+1],i);if(e+=r,!(f==h&&c==l)){var p=h-s,v=l-u,y=f-s,d=c-u;if(p*d==v*y&&(p<0&&y<p||p==y||p>0&&y>p)&&(v<0&&d<v||v==d||v>0&&d>v)){h=f,l=c;continue}o[a++]=h,o[a++]=l,s=h,u=l,h=f,l=c}}return o[a++]=h,o[a++]=l,a}function Qt(n,e,t,r,i,o,a,s){for(var u=0,h=t.length;u<h;++u){var l=t[u];a=Yr(n,e,l,r,i,o,a),s.push(a),e=l}return a}function Ur(n,e,t,r,i,o,a,s){for(var u=0,h=t.length;u<h;++u){var l=t[u],f=[];a=Qt(n,e,l,r,i,o,a,f),s.push(f),e=l[l.length-1]}return a}function qt(n,e,t,r,i){var o;for(e+=r;e<t;e+=r)if(o=i(n.slice(e-r,e),n.slice(e,e+r)),o)return o;return!1}function V(n,e,t,r,i){for(var o=i!==void 0?i:[],a=0,s=e;s<t;s+=r)o[a++]=n.slice(s,s+r);return o.length=a,o}function vt(n,e,t,r,i){for(var o=i!==void 0?i:[],a=0,s=0,u=t.length;s<u;++s){var h=t[s];o[a++]=V(n,e,h,r,o[a]),e=h}return o.length=a,o}function jr(n,e,t,r,i){for(var o=i!==void 0?i:[],a=0,s=0,u=t.length;s<u;++s){var h=t[s];o[a++]=vt(n,e,h,r,o[a]),e=h[h.length-1]}return o.length=a,o}function bt(n,e,t,r,i,o,a){var s,u,h=(t-e)/r;if(h===1)s=e;else if(h===2)s=e,u=i;else if(h!==0){for(var l=n[e],f=n[e+1],c=0,p=[0],v=e+r;v<t;v+=r){var y=n[v],d=n[v+1];c+=Math.sqrt((y-l)*(y-l)+(d-f)*(d-f)),p.push(c),l=y,f=d}var U=i*c,m=ar(p,U);m<0?(u=(U-p[-m-2])/(p[-m-1]-p[-m-2]),s=e+(-m-2)*r):s=e+m*r}for(var C=a>1?a:2,R=o||new Array(C),v=0;v<C;++v)R[v]=s===void 0?NaN:u===void 0?n[s+v]:q(n[s+v],n[s+r+v],u);return R}function yt(n,e,t,r,i,o){if(t==e)return null;var a;if(i<n[e+r-1])return o?(a=n.slice(e,e+r),a[r-1]=i,a):null;if(n[t-1]<i)return o?(a=n.slice(t-r,t),a[r-1]=i,a):null;if(i==n[e+r-1])return n.slice(e,e+r);for(var s=e/r,u=t/r;s<u;){var h=s+u>>1;i<n[(h+1)*r-1]?u=h:s=h+1}var l=n[s*r-1];if(i==l)return n.slice((s-1)*r,(s-1)*r+r);var f=n[(s+1)*r-1],c=(i-l)/(f-l);a=[];for(var p=0;p<r-1;++p)a.push(q(n[(s-1)*r+p],n[s*r+p],c));return a.push(i),a}function $r(n,e,t,r,i,o,a){if(a)return yt(n,e,t[t.length-1],r,i,o);var s;if(i<n[r-1])return o?(s=n.slice(0,r),s[r-1]=i,s):null;if(n[n.length-1]<i)return o?(s=n.slice(n.length-r),s[r-1]=i,s):null;for(var u=0,h=t.length;u<h;++u){var l=t[u];if(e!=l){if(i<n[e+r-1])return null;if(i<=n[l-1])return yt(n,e,l,r,i,!1);e=l}}return null}function Wr(n,e,t,r,i){var o=Be(i,function(a){return!F(n,e,t,r,a[0],a[1])});return!o}function F(n,e,t,r,i,o){for(var a=0,s=n[t-r],u=n[t-r+1];e<t;e+=r){var h=n[e],l=n[e+1];u<=o?l>o&&(h-s)*(o-u)-(i-s)*(l-u)>0&&a++:l<=o&&(h-s)*(o-u)-(i-s)*(l-u)<0&&a--,s=h,u=l}return a!==0}function gt(n,e,t,r,i,o){if(t.length===0||!F(n,e,t[0],r,i,o))return!1;for(var a=1,s=t.length;a<s;++a)if(F(n,t[a-1],t[a],r,i,o))return!1;return!0}function Kr(n,e,t,r,i,o){if(t.length===0)return!1;for(var a=0,s=t.length;a<s;++a){var u=t[a];if(gt(n,e,u,r,i,o))return!0;e=u[u.length-1]}return!1}function z(n,e,t,r,i){var o=St(et(),n,e,t,r);return He(i,o)?$e(i,o)||o[0]>=i[0]&&o[2]<=i[2]||o[1]>=i[1]&&o[3]<=i[3]?!0:qt(n,e,t,r,function(a,s){return ke(i,a,s)}):!1}function Dr(n,e,t,r,i){for(var o=0,a=t.length;o<a;++o){if(z(n,e,t[o],r,i))return!0;e=t[o]}return!1}function Br(n,e,t,r,i){return!!(z(n,e,t,r,i)||F(n,e,t,r,i[0],i[1])||F(n,e,t,r,i[0],i[3])||F(n,e,t,r,i[2],i[1])||F(n,e,t,r,i[2],i[3]))}function te(n,e,t,r,i){if(!Br(n,e,t[0],r,i))return!1;if(t.length===1)return!0;for(var o=1,a=t.length;o<a;++o)if(Wr(n,t[o-1],t[o],r,i)&&!z(n,t[o-1],t[o],r,i))return!1;return!0}function Hr(n,e,t,r,i){for(var o=0,a=t.length;o<a;++o){var s=t[o];if(te(n,e,s,r,i))return!0;e=s[s.length-1]}return!1}function Zr(n,e,t,r){for(var i=n[e],o=n[e+1],a=0,s=e+r;s<t;s+=r){var u=n[s],h=n[s+1];a+=Math.sqrt((u-i)*(u-i)+(h-o)*(h-o)),i=u,o=h}return a}var kr=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Vr=function(n){kr(e,n);function e(t,r){var i=n.call(this)||this;return i.flatMidpoint_=null,i.flatMidpointRevision_=-1,i.maxDelta_=-1,i.maxDeltaRevision_=-1,r!==void 0&&!Array.isArray(t[0])?i.setFlatCoordinates(r,t):i.setCoordinates(t,r),i}return e.prototype.appendCoordinate=function(t){this.flatCoordinates?O(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,r,i,o){return o<L(this.getExtent(),t,r)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ut(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),lt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,r,i,o))},e.prototype.forEachSegment=function(t){return qt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinateAtM=function(t,r){if(this.layout!=_.XYM&&this.layout!=_.XYZM)return null;var i=r!==void 0?r:!1;return yt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i)},e.prototype.getCoordinates=function(){return V(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinateAt=function(t,r){return bt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,r,this.stride)},e.prototype.getLength=function(){return Zr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},e.prototype.getSimplifiedGeometryInternal=function(t){var r=[];return r.length=pt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,r,0),new e(r,_.XY)},e.prototype.getType=function(){return P.LINE_STRING},e.prototype.intersectsExtent=function(t){return z(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.setCoordinates=function(t,r){this.setLayout(r,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=k(this.flatCoordinates,0,t,this.stride),this.changed()},e}(A),_t=Vr;function ee(n,e,t,r){for(var i=0,o=n[t-r],a=n[t-r+1];e<t;e+=r){var s=n[e],u=n[e+1];i+=a*s-o*u,o=s,a=u}return i/2}function re(n,e,t,r){for(var i=0,o=0,a=t.length;o<a;++o){var s=t[o];i+=ee(n,e,s,r),e=s}return i}function zr(n,e,t,r){for(var i=0,o=0,a=t.length;o<a;++o){var s=t[o];i+=re(n,e,s,r),e=s[s.length-1]}return i}var Jr=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Qr=function(n){Jr(e,n);function e(t,r){var i=n.call(this)||this;return i.maxDelta_=-1,i.maxDeltaRevision_=-1,r!==void 0&&!Array.isArray(t[0])?i.setFlatCoordinates(r,t):i.setCoordinates(t,r),i}return e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,r,i,o){return o<L(this.getExtent(),t,r)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ut(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),lt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,r,i,o))},e.prototype.getArea=function(){return ee(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return V(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var r=[];return r.length=pt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,r,0),new e(r,_.XY)},e.prototype.getType=function(){return P.LINEAR_RING},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,r){this.setLayout(r,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=k(this.flatCoordinates,0,t,this.stride),this.changed()},e}(A),ne=Qr,qr=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),br=function(n){qr(e,n);function e(t,r,i){var o=n.call(this)||this;if(o.ends_=[],o.maxDelta_=-1,o.maxDeltaRevision_=-1,Array.isArray(t[0]))o.setCoordinates(t,r);else if(r!==void 0&&i)o.setFlatCoordinates(r,t),o.ends_=i;else{for(var a=o.getLayout(),s=t,u=[],h=[],l=0,f=s.length;l<f;++l){var c=s[l];l===0&&(a=c.getLayout()),O(u,c.getFlatCoordinates()),h.push(u.length)}o.setFlatCoordinates(a,u),o.ends_=h}return o}return e.prototype.appendLineString=function(t){this.flatCoordinates?O(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,r,i,o){return o<L(this.getExtent(),t,r)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ht(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ft(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,r,i,o))},e.prototype.getCoordinateAtM=function(t,r,i){if(this.layout!=_.XYM&&this.layout!=_.XYZM||this.flatCoordinates.length===0)return null;var o=r!==void 0?r:!1,a=i!==void 0?i:!1;return $r(this.flatCoordinates,0,this.ends_,this.stride,t,o,a)},e.prototype.getCoordinates=function(){return vt(this.flatCoordinates,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getLineString=function(t){return t<0||this.ends_.length<=t?null:new _t(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,r=this.ends_,i=this.layout,o=[],a=0,s=0,u=r.length;s<u;++s){var h=r[s],l=new _t(t.slice(a,h),i);o.push(l),a=h}return o},e.prototype.getFlatMidpoints=function(){for(var t=[],r=this.flatCoordinates,i=0,o=this.ends_,a=this.stride,s=0,u=o.length;s<u;++s){var h=o[s],l=bt(r,i,h,a,.5);O(t,l),i=h}return t},e.prototype.getSimplifiedGeometryInternal=function(t){var r=[],i=[];return r.length=Xr(this.flatCoordinates,0,this.ends_,this.stride,t,r,0,i),new e(r,_.XY,i)},e.prototype.getType=function(){return P.MULTI_LINE_STRING},e.prototype.intersectsExtent=function(t){return Dr(this.flatCoordinates,0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,r){this.setLayout(r,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=ct(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()},e}(A),tn=br,en=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),rn=function(n){en(e,n);function e(t,r){var i=n.call(this)||this;return i.setCoordinates(t,r),i}return e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,r,i,o){var a=this.flatCoordinates,s=G(t,r,a[0],a[1]);if(s<o){for(var u=this.stride,h=0;h<u;++h)i[h]=a[h];return i.length=u,s}else return o},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return We(this.flatCoordinates,t)},e.prototype.getType=function(){return P.POINT},e.prototype.intersectsExtent=function(t){return Gt(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,r){this.setLayout(r,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ir(this.flatCoordinates,0,t,this.stride),this.changed()},e}(A),J=rn,nn=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),on=function(n){nn(e,n);function e(t,r){var i=n.call(this)||this;return r&&!Array.isArray(t[0])?i.setFlatCoordinates(r,t):i.setCoordinates(t,r),i}return e.prototype.appendPoint=function(t){this.flatCoordinates?O(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,r,i,o){if(o<L(this.getExtent(),t,r))return o;for(var a=this.flatCoordinates,s=this.stride,u=0,h=a.length;u<h;u+=s){var l=G(t,r,a[u],a[u+1]);if(l<o){o=l;for(var f=0;f<s;++f)i[f]=a[u+f];i.length=s}}return o},e.prototype.getCoordinates=function(){return V(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getPoint=function(t){var r=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||r<=t?null:new J(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)},e.prototype.getPoints=function(){for(var t=this.flatCoordinates,r=this.layout,i=this.stride,o=[],a=0,s=t.length;a<s;a+=i){var u=new J(t.slice(a,a+i),r);o.push(u)}return o},e.prototype.getType=function(){return P.MULTI_POINT},e.prototype.intersectsExtent=function(t){for(var r=this.flatCoordinates,i=this.stride,o=0,a=r.length;o<a;o+=i){var s=r[o],u=r[o+1];if(Gt(t,s,u))return!0}return!1},e.prototype.setCoordinates=function(t,r){this.setLayout(r,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=k(this.flatCoordinates,0,t,this.stride),this.changed()},e}(A),ie=on;function oe(n,e,t,r,i,o,a){for(var s,u,h,l,f,c,p,v=i[o+1],y=[],d=0,U=t.length;d<U;++d){var m=t[d];for(l=n[m-r],c=n[m-r+1],s=e;s<m;s+=r)f=n[s],p=n[s+1],(v<=c&&p<=v||c<=v&&v<=p)&&(h=(v-c)/(p-c)*(f-l)+l,y.push(h)),l=f,c=p}var C=NaN,R=-1/0;for(y.sort(jt),l=y[0],s=1,u=y.length;s<u;++s){f=y[s];var W=Math.abs(f-l);W>R&&(h=(l+f)/2,gt(n,e,t,r,h,v)&&(C=h,R=W)),l=f}return isNaN(C)&&(C=i[o]),a?(a.push(C,v,R),a):[C,v,R]}function an(n,e,t,r,i){for(var o=[],a=0,s=t.length;a<s;++a){var u=t[a];o=oe(n,e,u,r,i,2*a,o),e=u[u.length-1]}return o}function sn(n,e,t,r){for(;e<t-r;){for(var i=0;i<r;++i){var o=n[e+i];n[e+i]=n[t-r+i],n[t-r+i]=o}e+=r,t-=r}}function ae(n,e,t,r){for(var i=0,o=n[t-r],a=n[t-r+1];e<t;e+=r){var s=n[e],u=n[e+1];i+=(s-o)*(u+a),o=s,a=u}return i===0?void 0:i>0}function se(n,e,t,r,i){for(var o=i!==void 0?i:!1,a=0,s=t.length;a<s;++a){var u=t[a],h=ae(n,e,u,r);if(a===0){if(o&&h||!o&&!h)return!1}else if(o&&!h||!o&&h)return!1;e=u}return!0}function un(n,e,t,r,i){for(var o=0,a=t.length;o<a;++o){var s=t[o];if(!se(n,e,s,r,i))return!1;s.length&&(e=s[s.length-1])}return!0}function dt(n,e,t,r,i){for(var o=i!==void 0?i:!1,a=0,s=t.length;a<s;++a){var u=t[a],h=ae(n,e,u,r),l=a===0?o&&h||!o&&!h:o&&!h||!o&&h;l&&sn(n,e,u,r),e=u}return e}function ue(n,e,t,r,i){for(var o=0,a=t.length;o<a;++o)e=dt(n,e,t[o],r,i);return e}var hn=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),ln=function(n){hn(e,n);function e(t,r,i){var o=n.call(this)||this;return o.ends_=[],o.flatInteriorPointRevision_=-1,o.flatInteriorPoint_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,r!==void 0&&i?(o.setFlatCoordinates(r,t),o.ends_=i):o.setCoordinates(t,r),o}return e.prototype.appendLinearRing=function(t){this.flatCoordinates?O(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,r,i,o){return o<L(this.getExtent(),t,r)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ht(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ft(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,r,i,o))},e.prototype.containsXY=function(t,r){return gt(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,r)},e.prototype.getArea=function(){return re(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var r;return t!==void 0?(r=this.getOrientedFlatCoordinates().slice(),dt(r,0,this.ends_,this.stride,t)):r=this.flatCoordinates,vt(r,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=it(this.getExtent());this.flatInteriorPoint_=oe(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new J(this.getFlatInteriorPoint(),_.XYM)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new ne(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,r=this.flatCoordinates,i=this.ends_,o=[],a=0,s=0,u=i.length;s<u;++s){var h=i[s],l=new ne(r.slice(a,h),t);o.push(l),a=h}return o},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;se(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=dt(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var r=[],i=[];return r.length=Qt(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),r,0,i),new e(r,_.XY,i)},e.prototype.getType=function(){return P.POLYGON},e.prototype.intersectsExtent=function(t){return te(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,r){this.setLayout(r,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=ct(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()},e}(A),Et=ln;function fn(n,e,t,r){for(var i=[],o=et(),a=0,s=t.length;a<s;++a){var u=t[a];o=Lt(n,e,u[0],r),i.push((o[0]+o[2])/2,(o[1]+o[3])/2),e=u[u.length-1]}return i}var cn=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),pn=function(n){cn(e,n);function e(t,r,i){var o=n.call(this)||this;if(o.endss_=[],o.flatInteriorPointsRevision_=-1,o.flatInteriorPoints_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){for(var a=o.getLayout(),s=t,u=[],h=[],l=0,f=s.length;l<f;++l){var c=s[l];l===0&&(a=c.getLayout());for(var p=u.length,v=c.getEnds(),y=0,d=v.length;y<d;++y)v[y]+=p;O(u,c.getFlatCoordinates()),h.push(v)}r=a,t=u,i=h}return r!==void 0&&i?(o.setFlatCoordinates(r,t),o.endss_=i):o.setCoordinates(t,r),o}return e.prototype.appendPolygon=function(t){var r;if(!this.flatCoordinates)this.flatCoordinates=t.getFlatCoordinates().slice(),r=t.getEnds().slice(),this.endss_.push();else{var i=this.flatCoordinates.length;O(this.flatCoordinates,t.getFlatCoordinates()),r=t.getEnds().slice();for(var o=0,a=r.length;o<a;++o)r[o]+=i}this.endss_.push(r),this.changed()},e.prototype.clone=function(){for(var t=this.endss_.length,r=new Array(t),i=0;i<t;++i)r[i]=this.endss_[i].slice();var o=new e(this.flatCoordinates.slice(),this.layout,r);return o.applyProperties(this),o},e.prototype.closestPointXY=function(t,r,i,o){return o<L(this.getExtent(),t,r)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Fr(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Nr(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,r,i,o))},e.prototype.containsXY=function(t,r){return Kr(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,r)},e.prototype.getArea=function(){return zr(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},e.prototype.getCoordinates=function(t){var r;return t!==void 0?(r=this.getOrientedFlatCoordinates().slice(),ue(r,0,this.endss_,this.stride,t)):r=this.flatCoordinates,jr(r,0,this.endss_,this.stride)},e.prototype.getEndss=function(){return this.endss_},e.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=fn(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=an(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},e.prototype.getInteriorPoints=function(){return new ie(this.getFlatInteriorPoints().slice(),_.XYM)},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;un(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=ue(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var r=[],i=[];return r.length=Ur(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),r,0,i),new e(r,_.XY,i)},e.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;var r;if(t===0)r=0;else{var i=this.endss_[t-1];r=i[i.length-1]}var o=this.endss_[t].slice(),a=o[o.length-1];if(r!==0)for(var s=0,u=o.length;s<u;++s)o[s]-=r;return new Et(this.flatCoordinates.slice(r,a),this.layout,o)},e.prototype.getPolygons=function(){for(var t=this.layout,r=this.flatCoordinates,i=this.endss_,o=[],a=0,s=0,u=i.length;s<u;++s){var h=i[s].slice(),l=h[h.length-1];if(a!==0)for(var f=0,c=h.length;f<c;++f)h[f]-=a;var p=new Et(r.slice(a,l),t,h);o.push(p),a=l}return o},e.prototype.getType=function(){return P.MULTI_POLYGON},e.prototype.intersectsExtent=function(t){return Hr(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},e.prototype.setCoordinates=function(t,r){this.setLayout(r,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var i=xr(this.flatCoordinates,0,t,this.stride,this.endss_);if(i.length===0)this.flatCoordinates.length=0;else{var o=i[i.length-1];this.flatCoordinates.length=o.length===0?0:o[o.length-1]}this.changed()},e}(A),vn=pn,yn=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),gn=function(n){yn(e,n);function e(t){var r=n.call(this)||this;return r.geometries_=t||null,r.changeEventsKeys_=[],r.listenGeometriesChange_(),r}return e.prototype.unlistenGeometriesChange_=function(){this.changeEventsKeys_.forEach(H),this.changeEventsKeys_.length=0},e.prototype.listenGeometriesChange_=function(){if(!!this.geometries_)for(var t=0,r=this.geometries_.length;t<r;++t)this.changeEventsKeys_.push($(this.geometries_[t],st.CHANGE,this.changed,this))},e.prototype.clone=function(){var t=new e(null);return t.setGeometries(this.geometries_),t.applyProperties(this),t},e.prototype.closestPointXY=function(t,r,i,o){if(o<L(this.getExtent(),t,r))return o;for(var a=this.geometries_,s=0,u=a.length;s<u;++s)o=a[s].closestPointXY(t,r,i,o);return o},e.prototype.containsXY=function(t,r){for(var i=this.geometries_,o=0,a=i.length;o<a;++o)if(i[o].containsXY(t,r))return!0;return!1},e.prototype.computeExtent=function(t){nt(t);for(var r=this.geometries_,i=0,o=r.length;i<o;++i)Ke(t,r[i].getExtent());return t},e.prototype.getGeometries=function(){return he(this.geometries_)},e.prototype.getGeometriesArray=function(){return this.geometries_},e.prototype.getGeometriesArrayRecursive=function(){for(var t=[],r=this.geometries_,i=0,o=r.length;i<o;++i)r[i].getType()===this.getType()?t=t.concat(r[i].getGeometriesArrayRecursive()):t.push(r[i]);return t},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var r=[],i=this.geometries_,o=!1,a=0,s=i.length;a<s;++a){var u=i[a],h=u.getSimplifiedGeometry(t);r.push(h),h!==u&&(o=!0)}if(o){var l=new e(null);return l.setGeometriesArray(r),l}else return this.simplifiedGeometryMaxMinSquaredTolerance=t,this},e.prototype.getType=function(){return P.GEOMETRY_COLLECTION},e.prototype.intersectsExtent=function(t){for(var r=this.geometries_,i=0,o=r.length;i<o;++i)if(r[i].intersectsExtent(t))return!0;return!1},e.prototype.isEmpty=function(){return this.geometries_.length===0},e.prototype.rotate=function(t,r){for(var i=this.geometries_,o=0,a=i.length;o<a;++o)i[o].rotate(t,r);this.changed()},e.prototype.scale=function(t,r,i){var o=i;o||(o=it(this.getExtent()));for(var a=this.geometries_,s=0,u=a.length;s<u;++s)a[s].scale(t,r,o);this.changed()},e.prototype.setGeometries=function(t){this.setGeometriesArray(he(t))},e.prototype.setGeometriesArray=function(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()},e.prototype.applyTransform=function(t){for(var r=this.geometries_,i=0,o=r.length;i<o;++i)r[i].applyTransform(t);this.changed()},e.prototype.translate=function(t,r){for(var i=this.geometries_,o=0,a=i.length;o<a;++o)i[o].translate(t,r);this.changed()},e.prototype.disposeInternal=function(){this.unlistenGeometriesChange_(),n.prototype.disposeInternal.call(this)},e}(Vt);function he(n){for(var e=[],t=0,r=n.length;t<r;++t)e.push(n[t].clone());return e}var mt=gn,_n=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),dn=function(n){_n(e,n);function e(){return n.call(this)||this}return e.prototype.getType=function(){return mr.TEXT},e.prototype.readFeature=function(t,r){return this.readFeatureFromText(Q(t),this.adaptOptions(r))},e.prototype.readFeatureFromText=function(t,r){return E()},e.prototype.readFeatures=function(t,r){return this.readFeaturesFromText(Q(t),this.adaptOptions(r))},e.prototype.readFeaturesFromText=function(t,r){return E()},e.prototype.readGeometry=function(t,r){return this.readGeometryFromText(Q(t),this.adaptOptions(r))},e.prototype.readGeometryFromText=function(t,r){return E()},e.prototype.readProjection=function(t){return this.readProjectionFromText(Q(t))},e.prototype.readProjectionFromText=function(t){return this.dataProjection},e.prototype.writeFeature=function(t,r){return this.writeFeatureText(t,this.adaptOptions(r))},e.prototype.writeFeatureText=function(t,r){return E()},e.prototype.writeFeatures=function(t,r){return this.writeFeaturesText(t,this.adaptOptions(r))},e.prototype.writeFeaturesText=function(t,r){return E()},e.prototype.writeGeometry=function(t,r){return this.writeGeometryText(t,this.adaptOptions(r))},e.prototype.writeGeometryText=function(t,r){return E()},e}(Er);function Q(n){return typeof n=="string"?n:""}var En=dn,mn=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Tn={POINT:J,LINESTRING:_t,POLYGON:Et,MULTIPOINT:ie,MULTILINESTRING:tn,MULTIPOLYGON:vn},le="EMPTY",fe="Z",ce="M",Pn="ZM",g={START:0,TEXT:1,LEFT_PAREN:2,RIGHT_PAREN:3,NUMBER:4,COMMA:5,EOF:6},Cn={};for(var pe in P)Cn[pe]=P[pe].toUpperCase();var wn=function(){function n(e){this.wkt=e,this.index_=-1}return n.prototype.isAlpha_=function(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"},n.prototype.isNumeric_=function(e,t){var r=t!==void 0?t:!1;return e>="0"&&e<="9"||e=="."&&!r},n.prototype.isWhiteSpace_=function(e){return e==" "||e=="	"||e=="\r"||e==`
`},n.prototype.nextChar_=function(){return this.wkt.charAt(++this.index_)},n.prototype.nextToken=function(){var e=this.nextChar_(),t=this.index_,r=e,i;if(e=="(")i=g.LEFT_PAREN;else if(e==",")i=g.COMMA;else if(e==")")i=g.RIGHT_PAREN;else if(this.isNumeric_(e)||e=="-")i=g.NUMBER,r=this.readNumber_();else if(this.isAlpha_(e))i=g.TEXT,r=this.readText_();else{if(this.isWhiteSpace_(e))return this.nextToken();if(e==="")i=g.EOF;else throw new Error("Unexpected character: "+e)}return{position:t,value:r,type:i}},n.prototype.readNumber_=function(){var e,t=this.index_,r=!1,i=!1;do e=="."?r=!0:(e=="e"||e=="E")&&(i=!0),e=this.nextChar_();while(this.isNumeric_(e,r)||!i&&(e=="e"||e=="E")||i&&(e=="-"||e=="+"));return parseFloat(this.wkt.substring(t,this.index_--))},n.prototype.readText_=function(){var e,t=this.index_;do e=this.nextChar_();while(this.isAlpha_(e));return this.wkt.substring(t,this.index_--).toUpperCase()},n}(),Rn=function(){function n(e){this.lexer_=e,this.token_={position:0,type:g.START},this.layout_=_.XY}return n.prototype.consume_=function(){this.token_=this.lexer_.nextToken()},n.prototype.isTokenType=function(e){return this.token_.type==e},n.prototype.match=function(e){var t=this.isTokenType(e);return t&&this.consume_(),t},n.prototype.parse=function(){return this.consume_(),this.parseGeometry_()},n.prototype.parseGeometryLayout_=function(){var e=_.XY,t=this.token_;if(this.isTokenType(g.TEXT)){var r=t.value;r===fe?e=_.XYZ:r===ce?e=_.XYM:r===Pn&&(e=_.XYZM),e!==_.XY&&this.consume_()}return e},n.prototype.parseGeometryCollectionText_=function(){if(this.match(g.LEFT_PAREN)){var e=[];do e.push(this.parseGeometry_());while(this.match(g.COMMA));if(this.match(g.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())},n.prototype.parsePointText_=function(){if(this.match(g.LEFT_PAREN)){var e=this.parsePoint_();if(this.match(g.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())},n.prototype.parseLineStringText_=function(){if(this.match(g.LEFT_PAREN)){var e=this.parsePointList_();if(this.match(g.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())},n.prototype.parsePolygonText_=function(){if(this.match(g.LEFT_PAREN)){var e=this.parseLineStringTextList_();if(this.match(g.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())},n.prototype.parseMultiPointText_=function(){if(this.match(g.LEFT_PAREN)){var e=void 0;if(this.token_.type==g.LEFT_PAREN?e=this.parsePointTextList_():e=this.parsePointList_(),this.match(g.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())},n.prototype.parseMultiLineStringText_=function(){if(this.match(g.LEFT_PAREN)){var e=this.parseLineStringTextList_();if(this.match(g.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())},n.prototype.parseMultiPolygonText_=function(){if(this.match(g.LEFT_PAREN)){var e=this.parsePolygonTextList_();if(this.match(g.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())},n.prototype.parsePoint_=function(){for(var e=[],t=this.layout_.length,r=0;r<t;++r){var i=this.token_;if(this.match(g.NUMBER))e.push(i.value);else break}if(e.length==t)return e;throw new Error(this.formatErrorMessage_())},n.prototype.parsePointList_=function(){for(var e=[this.parsePoint_()];this.match(g.COMMA);)e.push(this.parsePoint_());return e},n.prototype.parsePointTextList_=function(){for(var e=[this.parsePointText_()];this.match(g.COMMA);)e.push(this.parsePointText_());return e},n.prototype.parseLineStringTextList_=function(){for(var e=[this.parseLineStringText_()];this.match(g.COMMA);)e.push(this.parseLineStringText_());return e},n.prototype.parsePolygonTextList_=function(){for(var e=[this.parsePolygonText_()];this.match(g.COMMA);)e.push(this.parsePolygonText_());return e},n.prototype.isEmptyGeometry_=function(){var e=this.isTokenType(g.TEXT)&&this.token_.value==le;return e&&this.consume_(),e},n.prototype.formatErrorMessage_=function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"},n.prototype.parseGeometry_=function(){var e=this.token_;if(this.match(g.TEXT)){var t=e.value;this.layout_=this.parseGeometryLayout_();var r=this.isEmptyGeometry_();if(t=="GEOMETRYCOLLECTION"){if(r)return new mt([]);var i=this.parseGeometryCollectionText_();return new mt(i)}else{var o=Tn[t];if(!o)throw new Error("Invalid geometry type: "+t);var a=void 0;if(r)t=="POINT"?a=[NaN,NaN]:a=[];else switch(t){case"POINT":{a=this.parsePointText_();break}case"LINESTRING":{a=this.parseLineStringText_();break}case"POLYGON":{a=this.parsePolygonText_();break}case"MULTIPOINT":{a=this.parseMultiPointText_();break}case"MULTILINESTRING":{a=this.parseMultiLineStringText_();break}case"MULTIPOLYGON":{a=this.parseMultiPolygonText_();break}}return new o(a,this.layout_)}}throw new Error(this.formatErrorMessage_())},n}(),On=function(n){mn(e,n);function e(t){var r=n.call(this)||this,i=t||{};return r.splitCollection_=i.splitCollection!==void 0?i.splitCollection:!1,r}return e.prototype.parse_=function(t){var r=new wn(t),i=new Rn(r);return i.parse()},e.prototype.readFeatureFromText=function(t,r){var i=this.readGeometryFromText(t,r),o=new Ht;return o.setGeometry(i),o},e.prototype.readFeaturesFromText=function(t,r){var i=[],o=this.readGeometryFromText(t,r);this.splitCollection_&&o.getType()==P.GEOMETRY_COLLECTION?i=o.getGeometriesArray():i=[o];for(var a=[],s=0,u=i.length;s<u;++s){var h=new Ht;h.setGeometry(i[s]),a.push(h)}return a},e.prototype.readGeometryFromText=function(t,r){var i=this.parse_(t);return Zt(i,!1,r)},e.prototype.writeFeatureText=function(t,r){var i=t.getGeometry();return i?this.writeGeometryText(i,r):""},e.prototype.writeFeaturesText=function(t,r){if(t.length==1)return this.writeFeatureText(t[0],r);for(var i=[],o=0,a=t.length;o<a;++o)i.push(t[o].getGeometry());var s=new mt(i);return this.writeGeometryText(s,r)},e.prototype.writeGeometryText=function(t,r){return ge(Zt(t,!0,r))},e}(En);function ve(n){var e=n.getCoordinates();return e.length===0?"":e.join(" ")}function Gn(n){for(var e=[],t=n.getPoints(),r=0,i=t.length;r<i;++r)e.push("("+ve(t[r])+")");return e.join(",")}function Mn(n){for(var e=[],t=n.getGeometries(),r=0,i=t.length;r<i;++r)e.push(ge(t[r]));return e.join(",")}function Tt(n){for(var e=n.getCoordinates(),t=[],r=0,i=e.length;r<i;++r)t.push(e[r].join(" "));return t.join(",")}function Ln(n){for(var e=[],t=n.getLineStrings(),r=0,i=t.length;r<i;++r)e.push("("+Tt(t[r])+")");return e.join(",")}function ye(n){for(var e=[],t=n.getLinearRings(),r=0,i=t.length;r<i;++r)e.push("("+Tt(t[r])+")");return e.join(",")}function Sn(n){for(var e=[],t=n.getPolygons(),r=0,i=t.length;r<i;++r)e.push("("+ye(t[r])+")");return e.join(",")}function An(n){var e=n.getLayout(),t="";return(e===_.XYZ||e===_.XYZM)&&(t+=fe),(e===_.XYM||e===_.XYZM)&&(t+=ce),t}var Fn={Point:ve,LineString:Tt,Polygon:ye,MultiPoint:Gn,MultiLineString:Ln,MultiPolygon:Sn,GeometryCollection:Mn};function ge(n){var e=n.getType(),t=Fn[e],r=t(n);if(e=e.toUpperCase(),typeof n.getFlatCoordinates=="function"){var i=An(n);i.length>0&&(e+=" "+i)}return r.length===0?e+" "+le:e+"("+r+")"}var Nn=On;const In=({map:n})=>{const e=n.getView().calculateExtent(n.getSize()),t=tr(e,"EPSG:3857","EPSG:4326"),r=It(t);return[r,At(t),Ft(t),xt(t),r]},xn=n=>new Nn().writeFeatures(n,window.farmOS.map.projection);window.farm_farmlab={getCurrentViewExtentCoordinates:In,getFeaturesWKT:xn}});
